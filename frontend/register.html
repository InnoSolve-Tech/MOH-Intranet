<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Partner Registration - Ministry of Health Uganda</title>
    <!-- Added global.css import before specific styles -->
    <link rel="stylesheet" href="css/global.css" />
    <link rel="stylesheet" href="css/register.css" />
  </head>
  <body>
    <!-- Combined branding and stepper into a single header at the top -->
    <div class="page-header">
      <div class="branding-header">
        <div class="logo-section">
          <img
            src="./images/logo.png?height=60&width=60"
            alt="Ministry of Health Uganda"
            class="ministry-logo"
          />
          <div class="branding-text">
            <h1>Ministry of Health Uganda</h1>
            <p>Partner Registration System</p>
          </div>
        </div>
      </div>

      <div class="stepper-container">
        <div class="stepper">
          <div class="step active" data-step="1">
            <div class="step-number">1</div>
            <div class="step-title">Basic Info</div>
          </div>
          <div class="step" data-step="2">
            <div class="step-number">2</div>
            <div class="step-title">Contacts</div>
          </div>
          <div class="step" data-step="3">
            <div class="step-number">3</div>
            <div class="step-title">MoU</div>
          </div>
          <div class="step" data-step="4">
            <div class="step-number">4</div>
            <div class="step-title">Support Details</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Removed stepper from inside the card and simplified header -->
    <div class="container registration-container">
      <form id="registrationForm">
        <!-- Step 1: Basic Information -->
        <div class="form-step active" data-step="1">
          <div class="form-row">
            <div class="form-group">
              <label for="partnerName">Partner Name *</label>
              <input type="text" id="partnerName" name="partnerName" required />
            </div>
            <div class="form-group">
              <label for="acronym">Acronym</label>
              <input type="text" id="acronym" name="acronym" />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Partner Type *</label>
              <div id="partnerTypeGroup">
                <label
                  ><input
                    type="radio"
                    name="partnerType"
                    value="Local"
                    required
                  />
                  Local</label
                >
                <label
                  ><input
                    type="radio"
                    name="partnerType"
                    value="International"
                    required
                  />
                  International</label
                >
              </div>
            </div>

            <div class="form-group">
              <label for="category">Category *</label>
              <select id="category" name="category" disabled>
                <option value="">Select Category</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="officialPhone">Official Phone Number *</label>
              <input
                type="tel"
                id="officialPhone"
                name="officialPhone"
                value="+256"
                required
              />
            </div>
            <div class="form-group">
              <label for="officialEmail">Official Email *</label>
              <input
                type="email"
                id="officialEmail"
                name="officialEmail"
                required
              />
            </div>
          </div>

          <!-- Simplified address capture to single input field -->
          <div class="dynamic-section">
            <h4>Addresses</h4>
            <div id="addressesContainer">
              <div class="address-item">
                <input
                  type="text"
                  name="addresses[0]"
                  placeholder="Enter full address (e.g., 123 Main St, Kampala, Uganda)"
                  required
                />
              </div>
            </div>
            <button type="button" class="add-btn" onclick="addAddress()">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
              </svg>
              Add Address
            </button>
          </div>
        </div>

        <!-- Step 2: Contacts -->
        <div class="form-step" data-step="2">
          <div class="dynamic-section">
            <h4>Additional Contacts</h4>
            <div id="contactsContainer">
              <div class="contact-item">
                <div class="form-row">
                  <div class="form-group">
                    <input
                      type="text"
                      name="contacts[0][name]"
                      placeholder="Contact Name *"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="text"
                      name="contacts[0][position]"
                      placeholder="Position *"
                      required
                    />
                  </div>
                </div>
                <div class="form-row">
                  <div class="form-group">
                    <input
                      type="tel"
                      name="contacts[0][phone]"
                      placeholder="Phone Number *"
                      value="+256"
                      required
                    />
                  </div>
                  <div class="form-group">
                    <input
                      type="email"
                      name="contacts[0][email]"
                      placeholder="Email Address *"
                      required
                    />
                  </div>
                </div>
              </div>
            </div>
            <button type="button" class="add-btn" onclick="addContact()">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="currentColor"
              >
                <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
              </svg>
              Add Contact
            </button>
          </div>
        </div>

        <!-- Step 3: MoU -->
        <div class="form-step" data-step="3">
          <div class="checkbox-group">
            <input type="checkbox" id="hasMou" name="hasMou" />
            <label for="hasMou">We have an MoU with Ministry of Health</label>
          </div>

          <div class="mou-details" id="mouDetails" style="display: none">
            <div class="form-row">
              <div class="form-group">
                <label for="signedBy">Signed By (WHO Representative) *</label>
                <input type="text" id="signedBy" name="signedBy" required />
              </div>
              <div class="form-group">
                <label for="whoTitle">Title (WHO Representative) *</label>
                <input type="text" id="whoTitle" name="whoTitle" required />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="signedDate">Signed Date *</label>
                <input type="date" id="signedDate" name="signedDate" required />
              </div>
              <div class="form-group">
                <label for="expiryDate">Expiry Date</label>
                <input type="date" id="expiryDate" name="expiryDate" />
              </div>
            </div>

            <div class="form-group">
              <label for="mouFile">Upload MoU Document</label>
              <input
                type="file"
                id="mouFile"
                name="mouFile"
                accept="application/pdf"
              />
            </div>
          </div>
        </div>

        <!-- Step 4: Support Details -->
        <div class="form-step" data-step="4">
          <div class="dynamic-section">
            <h4>Support Details</h4>
            <div class="support-years-header">
              <button
                type="button"
                class="add-btn"
                onclick="openAddSupportYearModal()"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" />
                </svg>
                Add Support Year
              </button>
            </div>
            <div
              id="supportYearsGrid"
              class="ag-theme-alpine"
              style="height: 300px; width: 100%; margin-top: 15px"
            ></div>
          </div>
        </div>

        <!-- Navigation -->
        <div class="form-navigation">
          <button
            type="button"
            class="nav-btn prev-btn"
            onclick="previousStep()"
            style="display: none"
          >
            Previous
          </button>
          <button type="button" class="nav-btn next-btn" onclick="nextStep()">
            Next
          </button>
          <button
            type="submit"
            class="nav-btn submit-btn"
            style="display: none"
          >
            Submit Registration
          </button>
        </div>
      </form>
    </div>

    <!-- Added modal for adding support years -->
    <div id="addSupportYearModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Add Support Year</h3>
          <span class="close" onclick="closeAddSupportYearModal()"
            >&times;</span
          >
        </div>
        <div class="modal-body">
          <form id="supportYearForm">
            <div class="form-row">
              <div class="form-group">
                <label>Year *</label>
                <input
                  type="number"
                  id="supportYear"
                  min="2020"
                  max="2030"
                  required
                />
              </div>
              <div class="form-group">
                <label>Quarter *</label>
                <select id="quarter" required>
                  <option value="">Select Quarter *</option>
                  <option value="First">First</option>
                  <option value="Second">Second</option>
                  <option value="Third">Third</option>
                  <option value="Fourth">Fourth</option>
                </select>
              </div>
              <div class="form-group">
                <label>Level of Support *</label>
                <select
                  id="supportLevel"
                  required
                  onchange="handleModalLevelChange()"
                >
                  <option value="">Select Level</option>
                  <option value="National">National</option>
                  <option value="District">District</option>
                </select>
              </div>
            </div>
            <!-- Added missing thematic areas dropdown -->
            <div class="form-group">
              <label>Thematic Areas Supported *</label>
              <select id="supportThematic" required>
                <option value="">Select Thematic Area</option>
              </select>
            </div>
            <div class="form-group">
              <label>Districts Supported *</label>
              <!-- Added multiple attribute to enable multi-select for districts -->
              <select
                id="supportDistricts"
                multiple
                required
                onchange="handleModalDistrictChange()"
              >
                <option value="Kampala">Kampala</option>
                <option value="Wakiso">Wakiso</option>
                <option value="Mukono">Mukono</option>
                <option value="Jinja">Jinja</option>
                <option value="Mbale">Mbale</option>
                <option value="Gulu">Gulu</option>
                <option value="Lira">Lira</option>
                <option value="Mbarara">Mbarara</option>
                <option value="Kasese">Kasese</option>
                <option value="Fort Portal">Fort Portal</option>
                <option value="Hoima">Hoima</option>
                <option value="Masaka">Masaka</option>
                <option value="Soroti">Soroti</option>
                <option value="Arua">Arua</option>
                <option value="Kabale">Kabale</option>
                <option value="Moroto">Moroto</option>
                <option value="Kitgum">Kitgum</option>
                <option value="Pader">Pader</option>
                <option value="Adjumani">Adjumani</option>
                <option value="Moyo">Moyo</option>
              </select>
              <!-- Updated help text to reflect new logic -->
              <small class="district-help-text"
                >Hold Ctrl/Cmd to select multiple districts when level is
                District</small
              >

              <div
                class="district-coverage-container"
                id="modalDistrictCoverage"
                style="display: none"
              >
                <h5>District Coverage</h5>
                <div class="coverage-options" id="modalCoverageOptions"></div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="nav-btn"
            onclick="closeAddSupportYearModal()"
          >
            Cancel
          </button>
          <button type="button" class="nav-btn" onclick="saveSupportYear()">
            Add Support Year
          </button>
        </div>
      </div>
    </div>

    <!-- Added ag-grid CDN -->
    <script src="https://cdn.jsdelivr.net/npm/ag-grid-community@31.0.0/dist/ag-grid-community.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="js/register.js"></script>
  </body>
</html>
